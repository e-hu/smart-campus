{include file="common/header" title="设备注册" keywords="设备注册" description="" /}
<ul class="bgf clear SSheader W">
    <li class="hl50 F_ bbd bgf tc bgdefault cf fr6">
        <p class='W'>设备注册</p>
    </li>
</ul>
<div id="app" class="f H scroll bgf mt50" v-cloak>
    <div class="bgf p20-10 bbe F_">
        <span>设备序列号：</span>
        <span class="f ml20">
				<input type="text" class="W bn" readonly placeholder="请输入设备序列号" v-model="machine_sn"/>
			</span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>设备类别：</span>
        <span class="f ml20">
				 <select class="weui-select H lh" name="select2">
            <option value="1">套餐取餐</option>
            <option value="2">自动查询机</option>
                      <option value="2">现金取餐</option>
            </select>
			</span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>应用服务器地址：</span>
        <span class="f ml20">
    <input type="text" class="W bn" placeholder="请输入应用服务器地址" value=""/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>餐厅：</span>
        <span class="f ml20">
     <select class="weui-select H lh" name="canteen_no">
            <option v-for="item in canteen_list" value="item.canteen_no">{{item.canteen_name}}</option>
            </select>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>窗口：</span>
        <span class="f ml20">
    <select class="weui-select H lh" name="sale_window_no">
               <option v-for="item in windows_list" value="item.sale_window_no">{{item.sale_window_name}}</option>
            </select>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>指纹识别方式：</span>
        <span class="f ml20">
    <select class="weui-select H lh" name="select2">
            <option value="1">函数识别</option>
            <option value="2">控件识别</option>
            </select>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>数据交互方式：</span>
        <span class="f ml20">
    <select class="weui-select H lh" name="select2">
            <option value="1">函数识别</option>
            <option value="2">控件识别</option>
            </select>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>指纹模版版本：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>指纹验证最低评分：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>指纹验证直接通过评分：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>指纹质量最低通过评分：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>串口参数：</span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>串口号：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>串口波特率：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>奇偶校验方式：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>数据位长度：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="bgf p20-10 bbe F_">
        <span>停止位长度：</span>
        <span class="f ml20">
    <input type="password" class="W bn" readonly value="11111"/>
    </span>
    </div>
    <div class="pt40">
        <button class="bgdefault W9 r2 cf p10 f16 Ml5" @click="cardBing">确定</button>
    </div>
</div>
{include file="common/footer" /}
<script type="text/javascript">
    window.onload = function () {
        var data = {
            machine_sn: getUrlParam('machine_sn'),
            windows_list: [],
            canteen_list: [],
        };
        new Vue({
            el: '#app',
            data: data,
            methods: {
                configInfo: function () {
                    var self = this;
                    if (!self.machine_sn) {
                        $.alert('设备号参数错误,请重新扫码!', function () {
                            openWin('index/index/me', {});
                        });
                    }
                    $.ajax({
                        url: '/index/mallapi/device',
                        type: "POST",
                        data: {machine_sn: self.machine_sn},
                        dataType: "json",
                        success: function (ret) {
                             console.log(ret);
                            if (ret.code == '0') {
                                $.alert(ret.msg, function () {
                                    openWin(ret.url, {});
                                });
                            } else {
                                self.canteen_list = ret.canteen_list;
                                self.windows_list = ret.windows_list;
                            }
                        }
                    });
                },
                cardBing: function () {
                    var self = this;
                    $.ajax({
                        url: '/index/mallapi/cardBind',
                        type: "POST",
                        data: {machine_sn: self.machine_sn},
                        dataType: "json",
                        success: function (ret) {
                            if (ret.code == '0') {
                                $.alert(ret.msg);
                            } else {
                                $.alert(ret.msg, function () {
                                    openWin(ret.url, {});
                                });
                            }
                        }
                    });
                }
            },
            mounted: function () {
                this.$nextTick(function () {
                    this.configInfo();
                })
            }
        });
    }

</script>