{include file="common/header"  title="今日菜谱" keywords="今日菜谱" description=""/}
<div class="f fr6 scroll H animsition">
    <ul class="bgf clear">
        <li class="hl50 F_ bbd bgf">
            <p class='f pl10'>{{date}}</p>
        </li>
    </ul>
    <div class="tc pt50" v-if="cartGetCount == '0'">
        <img src="__PUBLIC__/static/index/images/menu_st.png" class="h80 lh80 mb5">
        <p class="c9 mb15">今日菜谱空空如也！</p>
        <button class="bgdefault cf p10-20 r4" onclick="openWin('/index/index',{})">去其他日期选购订餐</button>
    </div>
    <div v-else class="W scroll H92">
        <ul class="tc clear H5">
            <li class="H W5 pr05 fl ptinfo" v-for="item in cartProductList">
                <img src="{{item.cookbook_image}}?imageslim" class="H7 W">
                <div class="bgf H3 W">
                    <div class="ptcheckinfo W tc">
                        <span>{{item.canteen_name}}</span><span class="pl10">{{item.dinner_name}}</span><br><span>{{item.cookbook_name}}</span><br/> <span class="c9">￥<span class="SScorange">{{item.cook_money}}</span>元/份</span>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
<!-- 底部导航栏 -->
<div class="bgf btd tc f12 c9 h60 SSfooter animsition">
    <div class="C4" onclick="window.location.href='/index/index/index'">
        <div class="h30 lh30 mt5">
            <img src="__PUBLIC__/static/index/images/home.png" class="h30 lh30">
        </div>
        <div class=" h24 lh20">首页</div>
    </div>
    <div class="C4" onclick="window.location.href='/index/index/menu'">
        <div class="h30 lh30 mt5">
            <img src="__PUBLIC__/static/index/images/menu-g.png" class="h30 lh30">
        </div>
        <div class="h24 lh20 SScmenu">今日菜谱</div>
    </div>
    <div class="C4" onclick="window.location.href='/index/index/me'">
        <div class="h30 lh30 mt5">
            <img src="__PUBLIC__/static/index/images/me.png" class="h30 lh30">
        </div>
        <div class="h24 lh20">个人中心</div>
    </div>
</div>
{include file="common/footer" /}
<script type="text/javascript">
    window.onload = function () {
        document.title = '今日菜谱';
        var d=new Date();
        var day=d.getDate();
        var month=d.getMonth() + 1;
        var year=d.getFullYear();
        var data = {
            day: year + "-" + month + "-" + day,
            cartProductList: [],
            cartGetCount: '0',
            date: '',
            cart_priceId: '',
            price_total: '',
            price_num: '',
            dinner_status:''
        };
        var V3 = new Vue({
                el: 'body',
                data: data,
                methods: {
                    initClassObj: function () {
                        var self = this;
                        $.ajax({
                            url: SCapiDic.orderProductList,
                            type: "POST",
                            dataType: "json",
                            data: {
                                day: self.day
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                //alert("请求对象XMLHttpRequest: "+JSON.stringify(XMLHttpRequest));
                            },
                            success: function (ret) {
                                if (ret.code == '0') {
                                    self.date = ret.data.date;
                                } else {
                                    self.date = ret.date;
                                    self.price_total = ret.price_total;
                                    self.price_num = ret.price_num;
                                    self.dinner_status = ret.dinner_status;
                                    self.initCartObj();
                                }
                            }
                        });
                    },
                    initCartObj: function () {
                        var self = this;
                        $.ajax({
                            url: SCapiDic.orderCartList,
                            type: "POST",
                            dataType: "json",
                            data: {
                                day: self.day
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                //alert("请求对象XMLHttpRequest: "+JSON.stringify(XMLHttpRequest));
                            },
                            success: function (ret) {
                                if (ret.code == '0') {
                                    self.date = ret.data.date;
                                } else {
                                    self.cartGetCount = ret.cartCount;
                                    self.cartProductList = ret.cartList;
                                }
                            }
                        });
                    }
                },
                ready: function () {
                    this.initClassObj();
                }
            })
        ;
    };
</script>



